<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üêï –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å–µ–º –ê—Ä—á–∏</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 20px rgba(59, 130, 246, 0.4); }
            50% { box-shadow: 0 0 30px rgba(59, 130, 246, 0.7); }
        }
        .pulse-glow { animation: pulse-glow 2s infinite; }
        .archie-avatar { 
            width: 120px; 
            height: 120px; 
            border-radius: 50%; 
            object-fit: cover;
            border: 3px solid white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50">
    <div id="app"></div>

    <script>
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        const state = {
            activeTab: 'dashboard',
            apiKey: '',
            apiProvider: 'anthropic',
            showApiSettings: false,
            archieAvatar: 'https://agi-prod-file-upload-public-main-use1.s3.amazonaws.com/96a9ee32-d2d4-49f7-8f55-8ee55a4f5665',
            archieData: {
                name: '–ê—Ä—á–∏',
                breed: '–ú–∏—à–ª–∏–Ω–≥',
                age: 11,
                weight: 21,
                status: '–ü–æ–¥ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ–º –ø–æ—Å–ª–µ –æ–ø–µ—Ä–∞—Ü–∏–∏',
                lastCheckup: '2024-12-05',
                medications: [
                    { name: '–£—Ä–∑–∞—Ö–æ–ª', dosage: '1 –∫–∞–ø—Å—É–ª–∞', times: ['09:00', '21:00'] },
                    { name: '–ì–µ–ø–∞—Ç–æ—Å–∞–Ω', dosage: '1 —Ç–∞–±–ª–µ—Ç–∫–∞', times: ['09:00', '18:00'] }
                ]
            },
            meals: [
                { id: 1, name: '–£—Ç—Ä–µ–Ω–Ω—è—è –ø–æ—Ä—Ü–∏—è', ingredients: ['–ö—É—Ä–∏—Ü–∞ 150–≥', '–†–∏—Å 100–≥', '–ú–æ—Ä–∫–æ–≤—å 50–≥'], calories: 420 },
                { id: 2, name: '–í–µ—á–µ—Ä–Ω—è—è –ø–æ—Ä—Ü–∏—è', ingredients: ['–ì–æ–≤—è–¥–∏–Ω–∞ 150–≥', '–ì—Ä–µ—á–∫–∞ 100–≥', '–¢—ã–∫–≤–∞ 50–≥'], calories: 450 }
            ],
            events: [
                { id: 1, type: 'walk', title: '–£—Ç—Ä–µ–Ω–Ω—è—è –ø—Ä–æ–≥—É–ª–∫–∞', time: '08:00', duration: '30 –º–∏–Ω', completed: true },
                { id: 2, type: 'medication', title: '–£—Ä–∑–∞—Ö–æ–ª', time: '09:00', completed: true },
                { id: 3, type: 'meal', title: '–ó–∞–≤—Ç—Ä–∞–∫', time: '09:30', completed: false },
                { id: 4, type: 'walk', title: '–î–Ω–µ–≤–Ω–∞—è –ø—Ä–æ–≥—É–ª–∫–∞', time: '14:00', duration: '45 –º–∏–Ω', completed: false },
                { id: 5, type: 'medication', title: '–ì–µ–ø–∞—Ç–æ—Å–∞–Ω', time: '18:00', completed: false },
                { id: 6, type: 'meal', title: '–£–∂–∏–Ω', time: '19:00', completed: false },
                { id: 7, type: 'walk', title: '–í–µ—á–µ—Ä–Ω—è—è –ø—Ä–æ–≥—É–ª–∫–∞', time: '21:00', duration: '20 –º–∏–Ω', completed: false }
            ],
            recipes: [
                { id: 1, name: '–ö—É—Ä–∏–Ω–æ–µ —Ä–∞–≥—É', ingredients: ['–ö—É—Ä–∏—Ü–∞', '–†–∏—Å', '–ú–æ—Ä–∫–æ–≤—å', '–ö–∞–±–∞—á–æ–∫'], calories: 850, portions: 2 },
                { id: 2, name: '–ì–æ–≤—è–∂–∏–π –º–∏–∫—Å', ingredients: ['–ì–æ–≤—è–¥–∏–Ω–∞', '–ì—Ä–µ—á–∫–∞', '–¢—ã–∫–≤–∞', '–Ø–±–ª–æ–∫–æ'], calories: 900, portions: 2 }
            ],
            documents: [
                { id: 1, name: '–ê–Ω–∞–ª–∏–∑—ã –∫—Ä–æ–≤–∏ 15.10.2024', type: 'pdf', size: '2.3 MB' },
                { id: 2, name: '–í—ã–ø–∏—Å–∫–∞ –ø–æ—Å–ª–µ –æ–ø–µ—Ä–∞—Ü–∏–∏', type: 'pdf', size: '1.8 MB' },
                { id: 3, name: '–í–µ—Ç–µ—Ä–∏–Ω–∞—Ä–Ω—ã–π –ø–∞—Å–ø–æ—Ä—Ç', type: 'pdf', size: '5.1 MB' }
            ],
            aiChat: [],
            aiInput: '',
            aiLoading: false,
            showAddMeal: false,
            showAddRecipe: false,
            newMeal: { name: '', ingredients: [''], calories: 0 },
            newRecipe: { name: '', ingredients: [''], calories: 0, portions: 1 },
            healthLogs: [
                { id: 1, date: '2024-12-07', time: '08:30', type: 'walk', notes: '–£—Ç—Ä–µ–Ω–Ω—è—è –ø—Ä–æ–≥—É–ª–∫–∞ 30 –º–∏–Ω, –∞–∫—Ç–∏–≤–Ω–∞—è, —Ö–æ—Ä–æ—à–µ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ', energy: '–≤—ã—Å–æ–∫–∞—è' },
                { id: 2, date: '2024-12-07', time: '09:00', type: 'medication', notes: '–£—Ä–∑–∞—Ö–æ–ª 1 –∫–∞–ø—Å—É–ª–∞ - –ø—Ä–∏–Ω—è–ª –Ω–æ—Ä–º–∞–ª—å–Ω–æ', side_effects: '–Ω–µ—Ç' },
                { id: 3, date: '2024-12-07', time: '12:00', type: 'weight', weight: 21.2, notes: '–í–µ—Å –≤ –Ω–æ—Ä–º–µ' },
                { id: 4, date: '2024-12-06', time: '19:00', type: 'health', notes: '–•—Ä–æ–º–æ—Ç–∞ –Ω–∞ –ª–µ–≤—É—é –∑–∞–¥–Ω—é—é –ª–∞–ø—É —É–º–µ–Ω—å—à–∏–ª–∞—Å—å, –¥–≤–∏–∂–µ–Ω–∏—è –±–æ–ª–µ–µ —Å–≤–æ–±–æ–¥–Ω—ã–µ', severity: '–ª–µ–≥–∫–∞—è' }
            ],
            showAddLog: false,
            newLog: { date: new Date().toISOString().split('T')[0], time: '12:00', type: 'health', notes: '', weight: '', energy: '', severity: '–ª–µ–≥–∫–∞—è', side_effects: '–Ω–µ—Ç' },
            graphData: {
                weight: [[2024-11-15, 22.1], [2024-11-20, 21.8], [2024-11-25, 21.5], [2024-12-01, 21.3], [2024-12-07, 21.2]],
                energy: { '2024-12-07': '–≤—ã—Å–æ–∫–∞—è', '2024-12-06': '—Å—Ä–µ–¥–Ω—è—è', '2024-12-05': '–≤—ã—Å–æ–∫–∞—è', '2024-12-04': '—Å—Ä–µ–¥–Ω—è—è', '2024-12-03': '–Ω–∏–∑–∫–∞—è' }
            },
            showStatistics: false,
            showAddTask: false,
            tasks: [
                { id: 1, title: '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ö—Ä–æ–º–æ—Ç—É –Ω–∞ –ª–µ–≤–æ–π –ª–∞–ø–µ', priority: '–≤—ã—Å–æ–∫–∏–π', dueDate: '2024-12-10', completed: false, category: '–∑–¥–æ—Ä–æ–≤—å–µ' },
                { id: 2, title: '–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –∫ –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä—É', priority: '–≤—ã—Å–æ–∫–∏–π', dueDate: '2024-12-15', completed: false, category: '–º–µ–¥–∏—Ü–∏–Ω–∞' },
                { id: 3, title: '–ö—É–ø–∏—Ç—å –≤–∏—Ç–∞–º–∏–Ω—ã –¥–ª—è —Å—É—Å—Ç–∞–≤–æ–≤', priority: '—Å—Ä–µ–¥–Ω–∏–π', dueDate: '2024-12-12', completed: false, category: '–ø–æ–∫—É–ø–∫–∏' },
                { id: 4, title: '–£–≤–µ–ª–∏—á–∏—Ç—å –ø—Ä–æ–≥—É–ª–∫–∏ –¥–æ 1 —á–∞—Å–∞', priority: '—Å—Ä–µ–¥–Ω–∏–π', dueDate: '2024-12-14', completed: false, category: '–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å' }
            ],
            newTask: { title: '', priority: '—Å—Ä–µ–¥–Ω–∏–π', dueDate: '', category: '–∑–¥–æ—Ä–æ–≤—å–µ', completed: false }
        };

        const calorieTarget = 870;

        function getDailyCalories() {
            return state.meals.reduce((sum, meal) => sum + meal.calories, 0);
        }

        function updateTab(tabId) {
            state.activeTab = tabId;
            render();
        }

        function toggleEvent(id) {
            const event = state.events.find(e => e.id === id);
            if (event) event.completed = !event.completed;
            render();
        }

        function openAddMeal() {
            state.showAddMeal = true;
            render();
        }

        function closeAddMeal() {
            state.showAddMeal = false;
            render();
        }

        function openAddRecipe() {
            state.showAddRecipe = true;
            render();
        }

        function closeAddRecipe() {
            state.showAddRecipe = false;
            render();
        }

        function addMeal() {
            if (state.newMeal.name && state.newMeal.ingredients[0]) {
                state.meals.push({ ...state.newMeal, id: Date.now() });
                state.newMeal = { name: '', ingredients: [''], calories: 0 };
                state.showAddMeal = false;
                render();
            }
        }

        function addRecipe() {
            if (state.newRecipe.name && state.newRecipe.ingredients[0]) {
                state.recipes.push({ ...state.newRecipe, id: Date.now() });
                state.newRecipe = { name: '', ingredients: [''], calories: 0, portions: 1 };
                state.showAddRecipe = false;
                render();
            }
        }

        function updateMealName(value) {
            state.newMeal.name = value;
        }

        function updateMealIngredient(index, value) {
            state.newMeal.ingredients[index] = value;
        }

        function addMealIngredient() {
            state.newMeal.ingredients.push('');
            render();
        }

        function updateMealCalories(value) {
            state.newMeal.calories = parseInt(value) || 0;
        }

        function updateRecipeName(value) {
            state.newRecipe.name = value;
        }

        function updateRecipeIngredient(index, value) {
            state.newRecipe.ingredients[index] = value;
        }

        function addRecipeIngredient() {
            state.newRecipe.ingredients.push('');
            render();
        }

        function updateRecipeCalories(value) {
            state.newRecipe.calories = parseInt(value) || 0;
        }

        function updateRecipePortions(value) {
            state.newRecipe.portions = parseInt(value) || 1;
        }

        function openApiSettings() {
            state.showApiSettings = true;
            render();
        }

        function closeApiSettings() {
            state.showApiSettings = false;
            render();
        }

        function updateApiKey(value) {
            state.apiKey = value;
        }

        function saveApiKey() {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            localStorage.setItem('archieApiKey', state.apiKey);
            localStorage.setItem('archieApiProvider', state.apiProvider);
            state.showApiSettings = false;
            render();
        }

        function loadApiSettings() {
            const savedKey = localStorage.getItem('archieApiKey');
            const savedProvider = localStorage.getItem('archieApiProvider');
            if (savedKey) state.apiKey = savedKey;
            if (savedProvider) state.apiProvider = savedProvider;
        }

        function updateApiProvider(value) {
            state.apiProvider = value;
            render();
        }

        function updateAiInput(value) {
            state.aiInput = value;
        }

        function openAddTask() {
            state.showAddTask = true;
            render();
        }

        function closeAddTask() {
            state.showAddTask = false;
            render();
        }

        function updateTaskField(field, value) {
            state.newTask[field] = value;
        }

        function addTask() {
            if (state.newTask.title && state.newTask.dueDate) {
                state.tasks.push({ ...state.newTask, id: Date.now() });
                state.newTask = { title: '', priority: '—Å—Ä–µ–¥–Ω–∏–π', dueDate: '', category: '–∑–¥–æ—Ä–æ–≤—å–µ', completed: false };
                state.showAddTask = false;
                localStorage.setItem('archieTasks', JSON.stringify(state.tasks));
                render();
            }
        }

        function toggleTask(id) {
            const task = state.tasks.find(t => t.id === id);
            if (task) {
                task.completed = !task.completed;
                localStorage.setItem('archieTasks', JSON.stringify(state.tasks));
                render();
            }
        }

        function deleteTask(id) {
            state.tasks = state.tasks.filter(t => t.id !== id);
            localStorage.setItem('archieTasks', JSON.stringify(state.tasks));
            render();
        }

        function openAddLog() {
            state.showAddLog = true;
            render();
        }

        function closeAddLog() {
            state.showAddLog = false;
            render();
        }

        function updateLogField(field, value) {
            state.newLog[field] = value;
        }

        function addHealthLog() {
            if (state.newLog.date && state.newLog.type) {
                const logEntry = { ...state.newLog, id: Date.now() };
                state.healthLogs.unshift(logEntry);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫–∏ –µ—Å–ª–∏ —ç—Ç–æ –≤–µ—Å
                if (state.newLog.type === 'weight' && state.newLog.weight) {
                    state.graphData.weight.push([new Date(state.newLog.date), parseFloat(state.newLog.weight)]);
                }
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
                localStorage.setItem('archieHealthLogs', JSON.stringify(state.healthLogs));
                
                state.newLog = { date: new Date().toISOString().split('T')[0], time: '12:00', type: 'health', notes: '', weight: '', energy: '', severity: '–ª–µ–≥–∫–∞—è', side_effects: '–Ω–µ—Ç' };
                state.showAddLog = false;
                render();
            }
        }

        function deleteLog(id) {
            state.healthLogs = state.healthLogs.filter(log => log.id !== id);
            localStorage.setItem('archieHealthLogs', JSON.stringify(state.healthLogs));
            render();
        }

        function downloadLogsAsCSV() {
            let csv = '–î–∞—Ç–∞,–í—Ä–µ–º—è,–¢–∏–ø,–ó–∞–º–µ—Ç–∫–∏,–≠–Ω–µ—Ä–≥–∏—è,–í–µ—Å,–¢—è–∂–µ—Å—Ç—å,–ü–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã\n';
            state.healthLogs.forEach(log => {
                csv += `"${log.date}","${log.time}","${log.type}","${log.notes || ''}","${log.energy || ''}","${log.weight || ''}","${log.severity || ''}","${log.side_effects || ''}"\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `archie_logs_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
        }

        function getLogTypeIcon(type) {
            const icons = {
                'walk': 'üö∂',
                'medication': 'üíä',
                'weight': '‚öñÔ∏è',
                'health': 'üè•',
                'mood': 'üòä',
                'appetite': 'üçñ',
                'bathroom': 'üöΩ'
            };
            return icons[type] || 'üìù';
        }

        function getLogTypeLabel(type) {
            const labels = {
                'walk': '–ü—Ä–æ–≥—É–ª–∫–∞',
                'medication': '–õ–µ–∫–∞—Ä—Å—Ç–≤–æ',
                'weight': '–í–µ—Å',
                'health': '–ó–¥–æ—Ä–æ–≤—å–µ',
                'mood': '–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ',
                'appetite': '–ê–ø–ø–µ—Ç–∏—Ç',
                'bathroom': '–¢—É–∞–ª–µ—Ç'
            };
            return labels[type] || '–ó–∞–º–µ—Ç–∫–∞';
        }

        function getEnergyColor(energy) {
            const colors = {
                '–≤—ã—Å–æ–∫–∞—è': 'bg-green-100 text-green-700',
                '—Å—Ä–µ–¥–Ω—è—è': 'bg-yellow-100 text-yellow-700',
                '–Ω–∏–∑–∫–∞—è': 'bg-red-100 text-red-700'
            };
            return colors[energy] || 'bg-gray-100 text-gray-700';
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ localStorage –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        window.addEventListener('load', function() {
            const saved = localStorage.getItem('archieHealthLogs');
            if (saved) {
                state.healthLogs = JSON.parse(saved);
            }
            const savedTasks = localStorage.getItem('archieTasks');
            if (savedTasks) {
                state.tasks = JSON.parse(savedTasks);
            }
            loadApiSettings();
        });

        async function sendAiMessage() {
            if (!state.aiInput.trim()) return;
            if (!state.apiKey) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –¥–æ–±–∞–≤—å—Ç–µ API –∫–ª—é—á –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö');
                return;
            }

            const userMessage = { role: 'user', content: state.aiInput };
            const currentInput = state.aiInput;
            state.aiChat.push(userMessage);
            state.aiInput = '';
            state.aiLoading = true;
            render();

            try {
                const systemPrompt = `–¢—ã –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è —Å–æ–±–∞–∫–∏ –ø–æ –∫–ª–∏—á–∫–µ –ê—Ä—á–∏. –î–∞–Ω–Ω—ã–µ: ${JSON.stringify(state.archieData)}. –û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ –¥–µ–ª—É.`;
                let response, data;

                if (state.apiProvider === 'anthropic') {
                    response = await fetch('https://api.anthropic.com/v1/messages', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'x-api-key': state.apiKey,
                            'anthropic-version': '2023-06-01'
                        },
                        body: JSON.stringify({
                            model: 'claude-3-5-sonnet-20241022',
                            max_tokens: 1024,
                            system: systemPrompt,
                            messages: [{ role: 'user', content: currentInput }]
                        })
                    });
                    data = await response.json();
                    if (data.content && data.content[0]) {
                        state.aiChat.push({ role: 'assistant', content: data.content[0].text });
                    } else {
                        throw new Error(data.error?.message || '–û—à–∏–±–∫–∞ API');
                    }

                } else if (state.apiProvider === 'openai') {
                    response = await fetch('https://api.openai.com/v1/chat/completions', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${state.apiKey}`
                        },
                        body: JSON.stringify({
                            model: 'gpt-4o-mini',
                            max_tokens: 1024,
                            system: systemPrompt,
                            messages: [{ role: 'user', content: currentInput }]
                        })
                    });
                    data = await response.json();
                    if (data.choices && data.choices[0]) {
                        state.aiChat.push({ role: 'assistant', content: data.choices[0].message.content });
                    } else {
                        throw new Error(data.error?.message || '–û—à–∏–±–∫–∞ API');
                    }

                } else if (state.apiProvider === 'huggingface') {
                    response = await fetch(`https://api-inference.huggingface.co/models/meta-llama/Llama-2-7b-chat-hf`, {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${state.apiKey}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            inputs: `${systemPrompt}\n\n–í–æ–ø—Ä–æ—Å: ${currentInput}`,
                            parameters: { max_length: 512 }
                        })
                    });
                    data = await response.json();
                    if (data[0] && data[0].generated_text) {
                        state.aiChat.push({ role: 'assistant', content: data[0].generated_text });
                    } else {
                        throw new Error('–û—à–∏–±–∫–∞ HuggingFace API');
                    }

                } else if (state.apiProvider === 'deepseek') {
                    response = await fetch('https://api.deepseek.com/chat/completions', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${state.apiKey}`
                        },
                        body: JSON.stringify({
                            model: 'deepseek-chat',
                            max_tokens: 1024,
                            system: systemPrompt,
                            messages: [{ role: 'user', content: currentInput }]
                        })
                    });
                    data = await response.json();
                    if (data.choices && data.choices[0]) {
                        state.aiChat.push({ role: 'assistant', content: data.choices[0].message.content });
                    } else {
                        throw new Error(data.error?.message || '–û—à–∏–±–∫–∞ API');
                    }
                }
            } catch (error) {
                const errorMessage = { role: 'assistant', content: `‚ö†Ô∏è –û—à–∏–±–∫–∞: ${error.message}` };
                state.aiChat.push(errorMessage);
            }
            state.aiLoading = false;
            render();
        }

        function render() {
            const app = document.getElementById('app');
            const dailyCalories = getDailyCalories();

            let content = '';

            if (state.activeTab === 'dashboard') {
                const walkCount = state.events.filter(e => e.type === 'walk' && e.completed).length;
                const walkTotal = state.events.filter(e => e.type === 'walk').length;
                const medCount = state.events.filter(e => e.type === 'medication' && e.completed).length;
                const medTotal = state.events.filter(e => e.type === 'medication').length;

                content = `
                    <div class="space-y-6">
                        <div class="bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 rounded-3xl p-8 text-white shadow-2xl pulse-glow">
                            <div class="flex items-center justify-between gap-6">
                                <div class="flex items-center gap-6">
                                    <img src="${state.archieAvatar}" alt="–ê—Ä—á–∏" class="archie-avatar">
                                    <div>
                                        <h2 class="text-4xl font-bold mb-2">üêï ${state.archieData.name}</h2>
                                        <p class="text-blue-100 mb-3 text-lg">${state.archieData.breed} ‚Ä¢ ${state.archieData.age} –ª–µ—Ç ‚Ä¢ ${state.archieData.weight} –∫–≥</p>
                                        <div class="bg-white/20 backdrop-blur-sm rounded-lg px-4 py-2 inline-block mb-2">
                                            <p class="text-sm font-semibold">${state.archieData.status}</p>
                                        </div>
                                        <p class="text-xs text-blue-100">–ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞: ${state.archieData.lastCheckup}</p>
                                    </div>
                                </div>
                                <button onclick="openApiSettings()" class="bg-white/20 hover:bg-white/30 p-3 rounded-lg transition">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                                </button>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="bg-white rounded-xl p-6 shadow-lg border-l-4 border-green-500">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-gray-500 text-sm">–ü—Ä–æ–≥—É–ª–∫–∏ —Å–µ–≥–æ–¥–Ω—è</p>
                                        <p class="text-3xl font-bold text-gray-800">${walkCount}/${walkTotal}</p>
                                    </div>
                                    <svg class="w-10 h-10 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 003 16.382V5.618a1 1 0 011.553-.894L9 7m0 13l6.447 3.268A1 1 0 0021 19.382V4.618a1 1 0 00-1.553-.894L15 7m0 13V7m0 0L9 4"></path></svg>
                                </div>
                            </div>

                            <div class="bg-white rounded-xl p-6 shadow-lg border-l-4 border-blue-500">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-gray-500 text-sm">–ö–∞–ª–æ—Ä–∏–∏ —Å–µ–≥–æ–¥–Ω—è</p>
                                        <p class="text-3xl font-bold text-gray-800">${dailyCalories}/${calorieTarget}</p>
                                    </div>
                                    <svg class="w-10 h-10 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path></svg>
                                </div>
                            </div>

                            <div class="bg-white rounded-xl p-6 shadow-lg border-l-4 border-purple-500">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-gray-500 text-sm">–õ–µ–∫–∞—Ä—Å—Ç–≤–∞</p>
                                        <p class="text-3xl font-bold text-gray-800">${medCount}/${medTotal}</p>
                                    </div>
                                    <svg class="w-10 h-10 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path></svg>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white rounded-xl p-6 shadow-lg">
                            <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                                <svg class="w-5 h-5 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
                            </h3>
                            <div class="space-y-3">
                                ${state.events.map(event => `
                                    <div class="flex items-center gap-4 p-4 rounded-lg transition ${event.completed ? 'bg-green-50 border border-green-200' : 'bg-gray-50 border border-gray-200'}">
                                        <input type="checkbox" ${event.completed ? 'checked' : ''} onchange="toggleEvent(${event.id})" class="w-5 h-5 rounded">
                                        <div class="flex-1">
                                            <p class="font-semibold ${event.completed ? 'line-through text-gray-500' : 'text-gray-800'}">${event.title}</p>
                                            <p class="text-sm text-gray-500">${event.time} ${event.duration ? '‚Ä¢ ' + event.duration : ''}</p>
                                        </div>
                                        <span class="px-3 py-1 rounded-full text-xs font-semibold ${
                                            event.type === 'walk' ? 'bg-green-100 text-green-700' :
                                            event.type === 'medication' ? 'bg-purple-100 text-purple-700' :
                                            'bg-blue-100 text-blue-700'
                                        }">
                                            ${event.type === 'walk' ? '–ü—Ä–æ–≥—É–ª–∫–∞' : event.type === 'medication' ? '–õ–µ–∫–∞—Ä—Å—Ç–≤–æ' : '–ï–¥–∞'}
                                        </span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            } else if (state.activeTab === 'nutrition') {
                const percentage = Math.round((dailyCalories / calorieTarget) * 100);
                content = `
                    <div class="space-y-6">
                        <div class="bg-white rounded-xl p-6 shadow-lg">
                            <h3 class="text-2xl font-bold mb-4">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø–∏—Ç–∞–Ω–∏—è</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                <div class="bg-gradient-to-r from-orange-100 to-orange-200 p-4 rounded-lg">
                                    <p class="text-sm text-orange-700 mb-1">–î–Ω–µ–≤–Ω–∞—è –Ω–æ—Ä–º–∞</p>
                                    <p class="text-3xl font-bold text-orange-800">${calorieTarget} –∫–∫–∞–ª</p>
                                </div>
                                <div class="bg-gradient-to-r from-green-100 to-green-200 p-4 rounded-lg">
                                    <p class="text-sm text-green-700 mb-1">–£–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è</p>
                                    <p class="text-3xl font-bold text-green-800">${dailyCalories} –∫–∫–∞–ª</p>
                                </div>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-4 mb-2">
                                <div class="h-4 rounded-full transition-all ${dailyCalories > calorieTarget ? 'bg-red-500' : 'bg-green-500'}"
                                     style="width: ${Math.min(percentage, 100)}%"></div>
                            </div>
                            <p class="text-sm text-gray-600 text-center">${percentage}% –æ—Ç –Ω–æ—Ä–º—ã</p>
                        </div>

                        <div class="bg-white rounded-xl p-6 shadow-lg">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-2xl font-bold">–°–µ–≥–æ–¥–Ω—è—à–Ω–µ–µ –º–µ–Ω—é</h3>
                                <button onclick="openAddMeal()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                                    –î–æ–±–∞–≤–∏—Ç—å
                                </button>
                            </div>
                            <div class="space-y-4">
                                ${state.meals.map(meal => `
                                    <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition">
                                        <h4 class="font-bold text-lg mb-2">${meal.name}</h4>
                                        <div class="flex flex-wrap gap-2 mb-3">
                                            ${meal.ingredients.map(ing => `<span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm">${ing}</span>`).join('')}
                                        </div>
                                        <p class="text-gray-600 font-semibold">${meal.calories} –∫–∫–∞–ª</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            } else if (state.activeTab === 'recipes') {
                content = `
                    <div class="space-y-6">
                        <div class="bg-white rounded-xl p-6 shadow-lg">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-2xl font-bold">–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ä–µ—Ü–µ–ø—Ç–æ–≤</h3>
                                <button onclick="openAddRecipe()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                                    –ù–æ–≤—ã–π —Ä–µ—Ü–µ–ø—Ç
                                </button>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                ${state.recipes.map(recipe => `
                                    <div class="border-2 border-gray-200 rounded-xl p-5 hover:border-blue-500 transition">
                                        <h4 class="font-bold text-xl mb-3">${recipe.name}</h4>
                                        <div class="flex flex-wrap gap-2 mb-3">
                                            ${recipe.ingredients.map(ing => `<span class="bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm">${ing}</span>`).join('')}
                                        </div>
                                        <div class="flex justify-between items-center text-sm">
                                            <span class="text-gray-600 font-semibold">${recipe.calories} –∫–∫–∞–ª</span>
                                            <span class="text-gray-600">${recipe.portions} –ø–æ—Ä—Ü–∏–∏</span>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            } else if (state.activeTab === 'documents') {
                content = `
                    <div class="space-y-6">
                        <div class="bg-white rounded-xl p-6 shadow-lg">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-2xl font-bold">–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã</h3>
                                <button class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                                    –ó–∞–≥—Ä—É–∑–∏—Ç—å
                                </button>
                            </div>
                            <div class="space-y-3">
                                ${state.documents.map(doc => `
                                    <div class="flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition">
                                        <div class="flex items-center gap-3">
                                            <svg class="w-8 h-8 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                                            <div>
                                                <p class="font-semibold">${doc.name}</p>
                                                <p class="text-sm text-gray-500">${doc.type.toUpperCase()} ‚Ä¢ ${doc.size}</p>
                                            </div>
                                        </div>
                                        <div class="flex gap-2">
                                            <button class="p-2 hover:bg-gray-200 rounded-lg">
                                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                                            </button>
                                            <button class="p-2 hover:bg-red-100 rounded-lg text-red-500">
                                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                                            </button>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            } else if (state.activeTab === 'logs') {
                content = `
                    <div class="space-y-6">
                        <div class="bg-white rounded-xl p-6 shadow-lg">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-2xl font-bold">üìã –ñ—É—Ä–Ω–∞–ª –∑–¥–æ—Ä–æ–≤—å—è</h3>
                                <div class="flex gap-2">
                                    <button onclick="openAddLog()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                                        –ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å
                                    </button>
                                    <button onclick="downloadLogsAsCSV()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center gap-2">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                                        –°–∫–∞—á–∞—Ç—å CSV
                                    </button>
                                </div>
                            </div>

                            <div class="space-y-3">
                                ${state.healthLogs.length === 0 ? '<p class="text-gray-500 text-center py-8">–õ–æ–≥–∏ –∑–¥–æ—Ä–æ–≤—å—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</p>' : ''}
                                ${state.healthLogs.map(log => `
                                    <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition">
                                        <div class="flex justify-between items-start mb-2">
                                            <div class="flex items-center gap-3">
                                                <span class="text-2xl">${getLogTypeIcon(log.type)}</span>
                                                <div>
                                                    <p class="font-bold text-lg">${getLogTypeLabel(log.type)}</p>
                                                    <p class="text-sm text-gray-500">${log.date} ‚Ä¢ ${log.time}</p>
                                                </div>
                                            </div>
                                            <button onclick="deleteLog(${log.id})" class="text-red-500 hover:text-red-700">
                                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                                            </button>
                                        </div>
                                        
                                        ${log.notes ? `<p class="text-gray-700 mb-2">${log.notes}</p>` : ''}
                                        
                                        <div class="flex flex-wrap gap-2">
                                            ${log.weight ? `<span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm">‚öñÔ∏è ${log.weight} –∫–≥</span>` : ''}
                                            ${log.energy ? `<span class="${getEnergyColor(log.energy)} px-3 py-1 rounded-full text-sm">‚ö° ${log.energy}</span>` : ''}
                                            ${log.severity ? `<span class="bg-purple-100 text-purple-700 px-3 py-1 rounded-full text-sm">üî¥ ${log.severity}</span>` : ''}
                                            ${log.side_effects && log.side_effects !== '–Ω–µ—Ç' ? `<span class="bg-red-100 text-red-700 px-3 py-1 rounded-full text-sm">‚ö†Ô∏è ${log.side_effects}</span>` : ''}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            } else if (state.activeTab === 'tasks') {
                const completedTasks = state.tasks.filter(t => t.completed).length;
                const tasksByPriority = {
                    –≤—ã—Å–æ–∫–∏–π: state.tasks.filter(t => t.priority === '–≤—ã—Å–æ–∫–∏–π' && !t.completed),
                    —Å—Ä–µ–¥–Ω–∏–π: state.tasks.filter(t => t.priority === '—Å—Ä–µ–¥–Ω–∏–π' && !t.completed),
                    –Ω–∏–∑–∫–∏–π: state.tasks.filter(t => t.priority === '–Ω–∏–∑–∫–∏–π' && !t.completed)
                };
                content = `
                    <div class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div class="bg-gradient-to-br from-blue-400 to-blue-600 rounded-xl p-6 text-white shadow-lg">
                                <p class="text-sm opacity-90 mb-1">–í—Å–µ–≥–æ –∑–∞–¥–∞—á</p>
                                <p class="text-3xl font-bold">${state.tasks.length}</p>
                            </div>
                            <div class="bg-gradient-to-br from-green-400 to-green-600 rounded-xl p-6 text-white shadow-lg">
                                <p class="text-sm opacity-90 mb-1">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</p>
                                <p class="text-3xl font-bold">${completedTasks}</p>
                            </div>
                            <div class="bg-gradient-to-br from-red-400 to-red-600 rounded-xl p-6 text-white shadow-lg">
                                <p class="text-sm opacity-90 mb-1">–°—Ä–æ—á–Ω—ã–µ</p>
                                <p class="text-3xl font-bold">${tasksByPriority.–≤—ã—Å–æ–∫–∏–π.length}</p>
                            </div>
                            <div class="bg-gradient-to-br from-purple-400 to-purple-600 rounded-xl p-6 text-white shadow-lg">
                                <p class="text-sm opacity-90 mb-1">–ü—Ä–æ–≥—Ä–µ—Å—Å</p>
                                <p class="text-3xl font-bold">${state.tasks.length > 0 ? Math.round((completedTasks / state.tasks.length) * 100) : 0}%</p>
                            </div>
                        </div>

                        <div class="bg-white rounded-xl p-6 shadow-lg">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-2xl font-bold">üìã –ó–∞–¥–∞—á–∏ –∑–¥–æ—Ä–æ–≤—å—è</h3>
                                <button onclick="openAddTask()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                                    –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞
                                </button>
                            </div>

                            <div class="space-y-6">
                                ${['–≤—ã—Å–æ–∫–∏–π', '—Å—Ä–µ–¥–Ω–∏–π', '–Ω–∏–∑–∫–∏–π'].map(priority => {
                                    const priorityLabel = { –≤—ã—Å–æ–∫–∏–π: 'üî¥ –°—Ä–æ—á–Ω—ã–µ', —Å—Ä–µ–¥–Ω–∏–π: 'üü° –í–∞–∂–Ω—ã–µ', –Ω–∏–∑–∫–∏–π: 'üü¢ –û–±—ã—á–Ω—ã–µ' }[priority];
                                    const tasks = state.tasks.filter(t => t.priority === priority);
                                    return `
                                        <div>
                                            <h4 class="text-lg font-bold mb-3 ${priority === '–≤—ã—Å–æ–∫–∏–π' ? 'text-red-600' : priority === '—Å—Ä–µ–¥–Ω–∏–π' ? 'text-yellow-600' : 'text-green-600'}">${priorityLabel}</h4>
                                            <div class="space-y-2">
                                                ${tasks.length === 0 ? '<p class="text-gray-400 text-sm">–ù–µ—Ç –∑–∞–¥–∞—á</p>' : ''}
                                                ${tasks.map(task => `
                                                    <div class="flex items-center gap-3 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition ${task.completed ? 'opacity-50' : ''}">
                                                        <input type="checkbox" ${task.completed ? 'checked' : ''} onchange="toggleTask(${task.id})" class="w-5 h-5 rounded cursor-pointer">
                                                        <div class="flex-1">
                                                            <p class="font-semibold ${task.completed ? 'line-through text-gray-500' : 'text-gray-800'}">${task.title}</p>
                                                            <p class="text-xs text-gray-500">üìÖ ${task.dueDate} ‚Ä¢ ${task.category}</p>
                                                        </div>
                                                        <button onclick="deleteTask(${task.id})" class="text-red-500 hover:text-red-700 p-2">
                                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                                                        </button>
                                                    </div>
                                                `).join('')}
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    </div>
                `;
            } else if (state.activeTab === 'ai') {
                content = `
                    <div class="space-y-6">
                        <div class="bg-white rounded-xl p-6 shadow-lg h-[600px] flex flex-col">
                            <h3 class="text-2xl font-bold mb-4 flex items-center gap-2">
                                <svg class="w-6 h-6 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12a9 9 0 11-18 0 9 9 0 0118 0zm3.879-10.879l-.707.707M3 12a9 9 0 1118 0 9 9 0 01-18 0zm10.879-10.879l.707.707M12 3v1"></path></svg>
                                –ò–ò-–ü–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –ê—Ä—á–∏
                            </h3>
                            <div class="flex-1 overflow-y-auto space-y-4 mb-4">
                                ${state.aiChat.length === 0 ? `
                                    <div class="text-center text-gray-500 mt-20">
                                        <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12a9 9 0 11-18 0 9 9 0 0118 0zm3.879-10.879l-.707.707M3 12a9 9 0 1118 0 9 9 0 01-18 0zm10.879-10.879l.707.707M12 3v1"></path></svg>
                                        <p>–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –æ –∑–¥–æ—Ä–æ–≤—å–µ, –ø–∏—Ç–∞–Ω–∏–∏ –∏–ª–∏ —É—Ö–æ–¥–µ –∑–∞ –ê—Ä—á–∏</p>
                                    </div>
                                ` : ''}
                                ${state.aiChat.map((msg, i) => `
                                    <div class="flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}">
                                        <div class="max-w-[80%] rounded-2xl p-4 ${
                                            msg.role === 'user' 
                                                ? 'bg-blue-500 text-white' 
                                                : 'bg-gray-100 text-gray-800'
                                        }">
                                            ${msg.content}
                                        </div>
                                    </div>
                                `).join('')}
                                ${state.aiLoading ? `
                                    <div class="flex justify-start">
                                        <div class="bg-gray-100 rounded-2xl p-4 text-gray-500">–î—É–º–∞—é...</div>
                                    </div>
                                ` : ''}
                            </div>
                            <div class="flex gap-2">
                                <input type="text" value="${state.aiInput}" oninput="updateAiInput(this.value)" onkeypress="if(event.key==='Enter') sendAiMessage()" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å..." class="flex-1 border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <button onclick="sendAiMessage()" ${state.aiLoading ? 'disabled' : ''} class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg ${state.aiLoading ? 'opacity-50' : ''}">
                                    –û—Ç–ø—Ä–∞–≤–∏—Ç—å
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }

            const html = `
                <div class="bg-white shadow-md sticky top-0 z-40">
                    <div class="max-w-7xl mx-auto px-4 py-4">
                        <h1 class="text-2xl font-bold text-gray-800">üêï –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å–µ–º –ê—Ä—á–∏</h1>
                    </div>
                </div>

                <div class="max-w-7xl mx-auto px-4 py-4">
                    <div class="bg-white rounded-xl shadow-lg p-2 flex flex-wrap gap-2">
                        <button onclick="updateTab('dashboard')" class="flex items-center gap-2 px-4 py-3 rounded-lg font-semibold transition ${state.activeTab === 'dashboard' ? 'bg-blue-500 text-white shadow-md' : 'text-gray-600 hover:bg-gray-100'}">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-3m0 0l7-4 7 4M5 9v10a1 1 0 001 1h12a1 1 0 001-1V9m-9 11l4-4"></path></svg>
                            <span class="hidden sm:inline">–ì–ª–∞–≤–Ω–∞—è</span>
                        </button>
                        <button onclick="updateTab('nutrition')" class="flex items-center gap-2 px-4 py-3 rounded-lg font-semibold transition ${state.activeTab === 'nutrition' ? 'bg-blue-500 text-white shadow-md' : 'text-gray-600 hover:bg-gray-100'}">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path></svg>
                            <span class="hidden sm:inline">–ü–∏—Ç–∞–Ω–∏–µ</span>
                        </button>
                        <button onclick="updateTab('recipes')" class="flex items-center gap-2 px-4 py-3 rounded-lg font-semibold transition ${state.activeTab === 'recipes' ? 'bg-blue-500 text-white shadow-md' : 'text-gray-600 hover:bg-gray-100'}">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path></svg>
                            <span class="hidden sm:inline">–†–µ—Ü–µ–ø—Ç—ã</span>
                        </button>
                        <button onclick="updateTab('documents')" class="flex items-center gap-2 px-4 py-3 rounded-lg font-semibold transition ${state.activeTab === 'documents' ? 'bg-blue-500 text-white shadow-md' : 'text-gray-600 hover:bg-gray-100'}">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path></svg>
                            <span class="hidden sm:inline">–î–æ–∫—É–º–µ–Ω—Ç—ã</span>
                        </button>
                        <button onclick="updateTab('logs')" class="flex items-center gap-2 px-4 py-3 rounded-lg font-semibold transition ${state.activeTab === 'logs' ? 'bg-blue-500 text-white shadow-md' : 'text-gray-600 hover:bg-gray-100'}">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                            <span class="hidden sm:inline">–ñ—É—Ä–Ω–∞–ª</span>
                        </button>
                        <button onclick="updateTab('ai')" class="flex items-center gap-2 px-4 py-3 rounded-lg font-semibold transition ${state.activeTab === 'ai' ? 'bg-blue-500 text-white shadow-md' : 'text-gray-600 hover:bg-gray-100'}">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12a9 9 0 11-18 0 9 9 0 0118 0zm3.879-10.879l-.707.707M3 12a9 9 0 1118 0 9 9 0 01-18 0zm10.879-10.879l.707.707M12 3v1"></path></svg>
                            <span class="hidden sm:inline">–ò–ò-–ü–æ–º–æ—â–Ω–∏–∫</span>
                        </button>
                        <button onclick="updateTab('tasks')" class="flex items-center gap-2 px-4 py-3 rounded-lg font-semibold transition ${state.activeTab === 'tasks' ? 'bg-blue-500 text-white shadow-md' : 'text-gray-600 hover:bg-gray-100'}">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                            <span class="hidden sm:inline">–ó–∞–¥–∞—á–∏</span>
                        </button>
                    </div>
                </div>

                <div class="max-w-7xl mx-auto px-4 py-6">
                    ${content}
                </div>

                ${state.showAddMeal ? `
                    <div class="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
                        <div class="bg-white rounded-xl p-6 max-w-md w-full">
                            <h3 class="text-xl font-bold mb-4">–ù–æ–≤—ã–π –ø—Ä–∏–µ–º –ø–∏—â–∏</h3>
                            <input type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" value="${state.newMeal.name}" oninput="updateMealName(this.value)" class="w-full border rounded-lg p-2 mb-3">
                            ${state.newMeal.ingredients.map((ing, i) => `
                                <input type="text" placeholder="–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç ${i + 1}" value="${ing}" oninput="updateMealIngredient(${i}, this.value)" class="w-full border rounded-lg p-2 mb-2">
                            `).join('')}
                            <button onclick="addMealIngredient()" class="text-blue-500 text-sm mb-3">+ –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç</button>
                            <input type="number" placeholder="–ö–∞–ª–æ—Ä–∏–∏" value="${state.newMeal.calories || ''}" oninput="updateMealCalories(this.value)" class="w-full border rounded-lg p-2 mb-4">
                            <div class="flex gap-2">
                                <button onclick="addMeal()" class="flex-1 bg-blue-500 text-white py-2 rounded-lg">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                                <button onclick="closeAddMeal()" class="flex-1 bg-gray-200 py-2 rounded-lg">–û—Ç–º–µ–Ω–∞</button>
                            </div>
                        </div>
                    </div>
                ` : ''}

                ${state.showAddRecipe ? `
                    <div class="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
                        <div class="bg-white rounded-xl p-6 max-w-md w-full">
                            <h3 class="text-xl font-bold mb-4">–ù–æ–≤—ã–π —Ä–µ—Ü–µ–ø—Ç</h3>
                            <input type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ—Ü–µ–ø—Ç–∞" value="${state.newRecipe.name}" oninput="updateRecipeName(this.value)" class="w-full border rounded-lg p-2 mb-3">
                            ${state.newRecipe.ingredients.map((ing, i) => `
                                <input type="text" placeholder="–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç ${i + 1}" value="${ing}" oninput="updateRecipeIngredient(${i}, this.value)" class="w-full border rounded-lg p-2 mb-2">
                            `).join('')}
                            <button onclick="addRecipeIngredient()" class="text-blue-500 text-sm mb-3">+ –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç</button>
                            <input type="number" placeholder="–ö–∞–ª–æ—Ä–∏–∏ (–æ–±—â–∏–µ)" value="${state.newRecipe.calories || ''}" oninput="updateRecipeCalories(this.value)" class="w-full border rounded-lg p-2 mb-3">
                            <input type="number" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ä—Ü–∏–π" value="${state.newRecipe.portions || ''}" oninput="updateRecipePortions(this.value)" class="w-full border rounded-lg p-2 mb-4">
                            <div class="flex gap-2">
                                <button onclick="addRecipe()" class="flex-1 bg-blue-500 text-white py-2 rounded-lg">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                                <button onclick="closeAddRecipe()" class="flex-1 bg-gray-200 py-2 rounded-lg">–û—Ç–º–µ–Ω–∞</button>
                            </div>
                        </div>
                    </div>
                ` : ''}

                ${state.showAddLog ? `
                    <div class="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
                        <div class="bg-white rounded-xl p-6 max-w-md w-full max-h-[90vh] overflow-y-auto">
                            <h3 class="text-xl font-bold mb-4">–ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å –≤ –∂—É—Ä–Ω–∞–ª</h3>
                            
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm font-semibold mb-1">–î–∞—Ç–∞</label>
                                    <input type="date" value="${state.newLog.date}" oninput="updateLogField('date', this.value)" class="w-full border rounded-lg p-2">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold mb-1">–í—Ä–µ–º—è</label>
                                    <input type="time" value="${state.newLog.time}" oninput="updateLogField('time', this.value)" class="w-full border rounded-lg p-2">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold mb-1">–¢–∏–ø –∑–∞–ø–∏—Å–∏</label>
                                    <select value="${state.newLog.type}" oninput="updateLogField('type', this.value)" class="w-full border rounded-lg p-2">
                                        <option value="health">üè• –ó–¥–æ—Ä–æ–≤—å–µ</option>
                                        <option value="walk">üö∂ –ü—Ä–æ–≥—É–ª–∫–∞</option>
                                        <option value="medication">üíä –õ–µ–∫–∞—Ä—Å—Ç–≤–æ</option>
                                        <option value="weight">‚öñÔ∏è –í–µ—Å</option>
                                        <option value="mood">üòä –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</option>
                                        <option value="appetite">üçñ –ê–ø–ø–µ—Ç–∏—Ç</option>
                                        <option value="bathroom">üöΩ –¢—É–∞–ª–µ—Ç</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold mb-1">–ó–∞–º–µ—Ç–∫–∏</label>
                                    <textarea value="${state.newLog.notes}" oninput="updateLogField('notes', this.value)" placeholder="–û–ø–∏—à–∏—Ç–µ —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ..." class="w-full border rounded-lg p-2 h-20 resize-none"></textarea>
                                </div>
                                
                                ${state.newLog.type === 'weight' ? `
                                    <div>
                                        <label class="block text-sm font-semibold mb-1">–í–µ—Å (–∫–≥)</label>
                                        <input type="number" step="0.1" value="${state.newLog.weight}" oninput="updateLogField('weight', this.value)" placeholder="21.5" class="w-full border rounded-lg p-2">
                                    </div>
                                ` : ''}
                                
                                ${['health', 'mood'].includes(state.newLog.type) ? `
                                    <div>
                                        <label class="block text-sm font-semibold mb-1">–≠–Ω–µ—Ä–≥–∏—è</label>
                                        <select value="${state.newLog.energy}" oninput="updateLogField('energy', this.value)" class="w-full border rounded-lg p-2">
                                            <option value="">–ù–µ —É–∫–∞–∑–∞–Ω–∞</option>
                                            <option value="–≤—ã—Å–æ–∫–∞—è">‚ö° –í—ã—Å–æ–∫–∞—è</option>
                                            <option value="—Å—Ä–µ–¥–Ω—è—è">‚ûñ –°—Ä–µ–¥–Ω—è—è</option>
                                            <option value="–Ω–∏–∑–∫–∞—è">üîª –ù–∏–∑–∫–∞—è</option>
                                        </select>
                                    </div>
                                ` : ''}
                                
                                ${state.newLog.type === 'health' ? `
                                    <div>
                                        <label class="block text-sm font-semibold mb-1">–¢—è–∂–µ—Å—Ç—å —Å–∏–º–ø—Ç–æ–º–∞</label>
                                        <select value="${state.newLog.severity}" oninput="updateLogField('severity', this.value)" class="w-full border rounded-lg p-2">
                                            <option value="–ª–µ–≥–∫–∞—è">üü¢ –õ–µ–≥–∫–∞—è</option>
                                            <option value="—Å—Ä–µ–¥–Ω—è—è">üü° –°—Ä–µ–¥–Ω—è—è</option>
                                            <option value="—Ç—è–∂–µ–ª–∞—è">üî¥ –¢—è–∂–µ–ª–∞—è</option>
                                        </select>
                                    </div>
                                ` : ''}
                                
                                ${state.newLog.type === 'medication' ? `
                                    <div>
                                        <label class="block text-sm font-semibold mb-1">–ü–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã</label>
                                        <input type="text" value="${state.newLog.side_effects}" oninput="updateLogField('side_effects', this.value)" placeholder="–Ω–µ—Ç" class="w-full border rounded-lg p-2">
                                    </div>
                                ` : ''}
                            </div>
                            
                            <div class="flex gap-2 mt-4">
                                <button onclick="addHealthLog()" class="flex-1 bg-blue-500 text-white py-2 rounded-lg font-semibold">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å</button>
                                <button onclick="closeAddLog()" class="flex-1 bg-gray-200 py-2 rounded-lg">–û—Ç–º–µ–Ω–∞</button>
                            </div>
                        </div>
                    </div>
                ` : ''}

                ${state.showAddTask ? `
                    <div class="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
                        <div class="bg-white rounded-xl p-6 max-w-md w-full">
                            <h3 class="text-xl font-bold mb-4">‚úÖ –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞</h3>
                            
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm font-semibold mb-1">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</label>
                                    <input type="text" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ..." value="${state.newTask.title}" oninput="updateTaskField('title', this.value)" class="w-full border rounded-lg p-2">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold mb-1">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                                    <select value="${state.newTask.priority}" oninput="updateTaskField('priority', this.value)" class="w-full border rounded-lg p-2">
                                        <option value="–≤—ã—Å–æ–∫–∏–π">üî¥ –°—Ä–æ—á–Ω–æ</option>
                                        <option value="—Å—Ä–µ–¥–Ω–∏–π">üü° –í–∞–∂–Ω–æ</option>
                                        <option value="–Ω–∏–∑–∫–∏–π">üü¢ –û–±—ã—á–Ω–æ</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold mb-1">–î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</label>
                                    <input type="date" value="${state.newTask.dueDate}" oninput="updateTaskField('dueDate', this.value)" class="w-full border rounded-lg p-2">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold mb-1">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                                    <select value="${state.newTask.category}" oninput="updateTaskField('category', this.value)" class="w-full border rounded-lg p-2">
                                        <option value="–∑–¥–æ—Ä–æ–≤—å–µ">üè• –ó–¥–æ—Ä–æ–≤—å–µ</option>
                                        <option value="–º–µ–¥–∏—Ü–∏–Ω–∞">üíä –ú–µ–¥–∏—Ü–∏–Ω–∞</option>
                                        <option value="–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å">üèÉ –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</option>
                                        <option value="–ø–∏—Ç–∞–Ω–∏–µ">üçñ –ü–∏—Ç–∞–Ω–∏–µ</option>
                                        <option value="–ø–æ–∫—É–ø–∫–∏">üõí –ü–æ–∫—É–ø–∫–∏</option>
                                        <option value="–ø—Ä–æ—á–µ–µ">üìå –ü—Ä–æ—á–µ–µ</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="flex gap-2 mt-4">
                                <button onclick="addTask()" class="flex-1 bg-blue-500 text-white py-2 rounded-lg font-semibold">–°–æ–∑–¥–∞—Ç—å</button>
                                <button onclick="closeAddTask()" class="flex-1 bg-gray-200 py-2 rounded-lg">–û—Ç–º–µ–Ω–∞</button>
                            </div>
                        </div>
                    </div>
                ` : ''}

                ${state.showApiSettings ? `
                    <div class="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
                        <div class="bg-white rounded-xl p-6 max-w-md w-full">
                            <h3 class="text-xl font-bold mb-4">üîë –ù–∞—Å—Ç—Ä–æ–π–∫–∏ API</h3>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-semibold mb-2">–ü—Ä–æ–≤–∞–π–¥–µ—Ä</label>
                                <select onchange="updateApiProvider(this.value)" class="w-full border rounded-lg p-2" value="${state.apiProvider}">
                                    <option value="anthropic" ${state.apiProvider === 'anthropic' ? 'selected' : ''}>ü§ñ Anthropic Claude</option>
                                    <option value="openai" ${state.apiProvider === 'openai' ? 'selected' : ''}>üîì OpenAI (GPT)</option>
                                    <option value="deepseek" ${state.apiProvider === 'deepseek' ? 'selected' : ''}>üîç DeepSeek</option>
                                    <option value="huggingface" ${state.apiProvider === 'huggingface' ? 'selected' : ''}>ü§ó HuggingFace</option>
                                </select>
                            </div>

                            <div class="mb-4">
                                <label class="block text-sm font-semibold mb-2">API –ö–ª—é—á</label>
                                <input type="password" value="${state.apiKey}" oninput="updateApiKey(this.value)" placeholder="${
                                    state.apiProvider === 'anthropic' ? 'sk-ant-...' :
                                    state.apiProvider === 'openai' ? 'sk-...' :
                                    state.apiProvider === 'deepseek' ? 'sk-...' :
                                    'hf_...'
                                }" class="w-full border rounded-lg p-3">
                            </div>

                            <p class="text-xs text-gray-500 mb-4">
                                ${
                                    state.apiProvider === 'anthropic' ? 'üìñ <a href="https://console.anthropic.com/keys" target="_blank" class="text-blue-500 underline">–ü–æ–ª—É—á–∏—Ç—å –∫–ª—é—á Anthropic</a>' :
                                    state.apiProvider === 'openai' ? 'üìñ <a href="https://platform.openai.com/api-keys" target="_blank" class="text-blue-500 underline">–ü–æ–ª—É—á–∏—Ç—å –∫–ª—é—á OpenAI</a>' :
                                    state.apiProvider === 'deepseek' ? 'üìñ <a href="https://platform.deepseek.com/api_keys" target="_blank" class="text-blue-500 underline">–ü–æ–ª—É—á–∏—Ç—å –∫–ª—é—á DeepSeek</a>' :
                                    'üìñ <a href="https://huggingface.co/settings/tokens" target="_blank" class="text-blue-500 underline">–ü–æ–ª—É—á–∏—Ç—å –∫–ª—é—á HuggingFace</a>'
                                }
                            </p>

                            <div class="flex gap-2">
                                <button onclick="saveApiKey()" class="flex-1 bg-blue-500 text-white py-2 rounded-lg flex items-center justify-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                                    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                                </button>
                                <button onclick="closeApiSettings()" class="flex-1 bg-gray-200 py-2 rounded-lg">–û—Ç–º–µ–Ω–∞</button>
                            </div>
                        </div>
                    </div>
                ` : ''}
            `;

            app.innerHTML = html;
        }

        render();
    </script>
</body>
</html>
